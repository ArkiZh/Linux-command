系统备份与还原
############################

在一个折腾无极限的年纪，手残、尝鲜、测试...谁都不能保证你的 Linux 每次都能顺利启动，提前做好系统备份会是一个明智的选择。

系统备份
****************************

备份系统就像备份或压缩其它文件一样，使用 ``tar`` 。只需要注意一点：备份需要 root 权限！

.. highlight:: none

::

    # cd /
    # tar -cvpzf backup.tgz –exclude=/proc –exclude=/lost+found –exclude=/backup.tgz –exclude=/mnt –exclude=/sys –exclude=/media /

来简单看一下这个命令：

- tar 备份系统所使用的程序名称

- cvpfz 命令选项，意思是“创建档案文件”、“保持权限”(保留所有东西原来的权限)、“使用gzip来压缩”。

- backup.gz 备份的文档名

- ``/`` 要备份的目录（整个文件系统）

- –exclude=/proc 不备份的目录。有些目录对于系统备份来说是没用的，例如“/proc”、“/lost+ found”、“/mnt”。当然，“backup.gz”也必须排除在外，否则可能会得到一些超出常理的结果。如果不把“/mnt”排除在外，那么挂载在“/mnt”上的其它分区也会被备份。

备份完成后，在文件系统的根目录将生成一个名为“backup.tgz”的文件。

在备份命令结束时你可能会看到这样一个提示： ``tar: Error exit delayed from previous errors`` ，多数情况下你可以忽略它。


系统还原
****************************

在进行系统还原时一定要小心！注意对重要数据的在备份，鸡蛋不能都放在一个篮子里！

在 Linux 中，可以在一个运行的系统中恢复当前系统，而不需要用 boot-cd 来专门引导。当然，如果你的系统已经挂掉不能启动了，你可以用 Live CD 来启动，效果是一样的。

使用下面的命令来恢复系统：

::

    # tar xvpfz backup.tgz -C /

注意：上面的命令会用档案文件中的文件覆盖分区上的所有文件。

恢复命令结束时，你的工作还没完成，别忘了重新创建那些在备份时被排除在外的目录：

::

    # mkdir proc
    # mkdir lost+found
    # mkdir mnt
    ...

然后重启电脑...
